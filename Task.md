# 背景

2014年是阿里巴巴集团移动电商业务快速发展的一年，例如2014双11大促中移动端成交占比达到42.6%，超过240亿元。相比PC时代，移动端网络的访问是随时随地的，具有更丰富的场景数据。
本次大赛提供了脱敏后的阿里巴巴移动电商平台数据，参赛队伍需要通过大数据和算法构建面向移动电子商务的商品推荐模型。

# 任务定义

在真实的业务场景下，我们往往需要对所有商品的一个子集构建个性化推荐模型。在完成这件任务的过程中，我们不仅需要利用用户在这个商品子集上的行为数据，往往还需要利用更丰富的用户行为数据。定义如下的符号：
U——用户集合
I——商品全集
P——商品子集，P ⊆ I
D——用户对商品全集的行为数据集合
那么我们的目标是利用D来构造U中用户对P中商品的推荐模型。

# 赛题数据

竞赛数据包含两个部分。第一部分是脱敏后的用户在商品上的移动端行为数据（D）,表名为tianchi_mobile_recommend_train_user，包含如下字段：

|     字段      |           字段说明           |                          提取说明                          |
| :-----------: | :--------------------------: | :--------------------------------------------------------: |
|    user_id    |           用户标识           |                 抽样&字段脱敏（非真实ID）                  |
|    item_id    |           商品标识           |                    字段脱敏（非真实ID）                    |
| behavior_type |     用户对商品的行为类型     | 包括浏览、收藏、加购物车、购买，对应取值分别是1、2、3、4。 |
| user_geohash  | 用户位置的空间标识，可以为空 |                 由经纬度通过保密的算法生成                 |
| item_category |         商品分类标识         |                    字段脱敏（非真实ID）                    |
|     time      |           行为时间           |                       精确到小时级别                       |

第二个部分是脱敏后的商品子集（P）,表名为tianchi_mobile_recommend_train_item，包含如下字段：

|     字段      |           字段说明           |          提取说明          |
| :-----------: | :--------------------------: | :------------------------: |
|    item_id    |           商品标识           | 抽样&字段脱敏（非真实ID）  |
| item_ geohash | 商品位置的空间标识，可以为空 | 由经纬度通过保密的算法生成 |
| item_category |         商品分类标识         |    字段脱敏（非真实ID）    |

训练数据包含了抽样出来的一定量用户在一个月时间（2014.11.18~2014.12.18）之内的移动端行为数据（D），评分数据是这些用户在这个一个月之后的一天（2014.12.19）对商品子集（P）的购买数据。参赛者要使用训练数据建立推荐模型，并输出用户在接下来一天对商品子集购买行为的预测结果。

# 输出格式

选手输出结果包含两列，分别是user_id和item_id, 以tab分隔，示例如下：

```
100017697	273020077
1100025197	92334510
1100030370	29240499
100062756	130930712
1100064788	16234722
1100064788	316904196
100073680	323228373
1100073680	333757713
1100073680	347872201
100077356	338630082
```

# 评测指标

比赛采用经典的精确度(precision)、召回率(recall)和F1值作为评估指标。具体计算公式如下：
$$\text{Precision} = \frac{|\cap (\text{PredictionSet}, \text{ReferenceSet})|}{|\text{PredictionSet}|}$$
$$
\text{Recall} = \frac{|\cap (\text{PredictionSet}, \text{ReferenceSet})|}{|\text{ReferenceSet}|}$$
$$\text{F1} = \frac{2 \times \text{Precision} \times \text{Recall}}{\text{Precision} + \text{Recall}}$$
其中PredictionSet为算法预测的购买数据集合，ReferenceSet为真实的答案购买数据集合。我们**以F1值作为最终的唯一评测标准**。

# FAQ

**1.大赛数据抽样方式？**
首先是抽取用户，从移动端对垂直行业商品在数据周期内（2014年11月18日 至 2014年12月19日） 有行为用户中抽取指定数量的用户，然后抽取这些用户在商品上的行为作为用户行为训练数据；抽取这些用户有行为的所有垂直行业商品作为商品子集，用户抽样的总体思想是随机抽样，同时保证预测日有购买的商品在训练周期内也是活跃商品（即排除预测日偶发购买的用户）。经过脱敏、去标识化等技术处理后，保证用户隐私的同时，形成大赛数据。

**2.商品子集都是什么垂直行业的商品？**
商品子集都是偏服务类的商品，涵盖阿里巴巴集团十个主要的商品大类，例如汽车售后服务、摄影服务、餐饮、电影等，其特色是线上购买、线下服务。

**3.用户和商品的位置哈希是怎么生成的？**
位置的哈希值是通过我们自己发明的一种空间哈希算法生成的，为了保护消费者隐私，具体计算过程对外保密；该哈希算法借鉴了GeoHash算法的思想，哈希值所代表的精确度范围约为150m*150m的矩形。哈希值的前缀代表了更大粒度的矩形格子，例如长度为6的前缀对应于1200m*600m的格子。

| 长度 |      格子大小       |
| :--: | :-----------------: |
|  1   | 5009.4km x 4992.6km |
|  2   | 1252.3km x 624.1km  |
|  3   |   156.5km x 156km   |
|  4   |   39.1km x 19.5km   |
|  5   |    4.9km x 4.9km    |
|  6   |   1.2km x 0.61km    |
|  7   |   152.9m x 152.4m   |

**4.四种用户行为的类型有什么区别？**
点击：点击行为是用户在网站上对商品的一次浏览点击行为。
加购物车：用户对商品的加入购物车行为，购物车本身有容量限制(50个商品)，用户可以在购物车中直接购买商品，或者删除购物车中商品。数据中没有提供用户删除购物车内商品的行为。
收藏：用户对商品的加入收藏夹行为，收藏夹本身没有容量限制，用户可以在收藏夹中直接购买商品，或者删除收藏夹中商品。数据中没有提供用户删除收藏夹内商品的行为。
购买：用户对商品的一次正常网购行为，即完成了购买操作；数据中没有提供用户退款、退货等交易纠纷行为。

**5.user_id, item_id, category_id字段是否为网站真实ID？**
所有ID类字段，包括user_id, item_id, category_id均已经脱敏，与网站真实ID不同，系统已保障了数据安全性。

**6.商品子集表中item_id为什么不唯一？**
商品与位置存在一对多的关联关系，一个商品可能关联到多个线下位置（比如一张洗车卡可以在爱义行的多家门店使用），因此item_id不唯一。

**7.为什么用户行为表中有的商品ID在商品子集表中没有？**
本竞赛的场景是面向垂直领域的推荐，即推荐的内容是垂直领域的商品。然而，用户对垂直领域内商品的行为与在垂直领域外的行为是有关联的，比如线上购买汽车轮胎（领域外）后可能会引发购买轮胎安装服务（领域内）。因此，给出的行为数据是用户在更大商品集合上的行为；事实上用户行为数据中的商品ID是未做任何限制的。

**8.用户行为训练数据中为什么会存在重复数据？**
用户行为的时间精确到小时，所以在一小时内是可能有完全重复的行为出现。用户对商品的重复浏览较常出现，也有可能存在有异常行为的用户，另外要注意的是，数据中用户对商品的一次购买行为，代表订单中包含对应商品，但是购买数量是未知的，两条购买数据代表两个不同的订单。